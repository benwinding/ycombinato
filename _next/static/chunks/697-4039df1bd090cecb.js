(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[697],{7862:function(e,t,r){"use strict";r.d(t,{E:function(){return s}});var n=r(9077),a=r(988),o=r(1821);let s=new n.QueryClient({defaultOptions:{queries:{cacheTime:36e5}}}),i=(0,a.O)({storage:(()=>{try{return window.localStorage}catch(e){return null}})()});(0,o.w)({queryClient:s,persistor:i,maxAge:36e5,hydrateOptions:{},dehydrateOptions:{}})},1170:function(e,t,r){"use strict";r.d(t,{Av:function(){return LinkToAuthor},It:function(){return LinkToDiscussionWrapper},dL:function(){return ExternalLink},iR:function(){return LinkToDiscussion}});var n=r(7437),a=r(7766);function ExternalLink(e){return(0,n.jsx)("a",{href:e.href,target:"_blank",referrerPolicy:"no-referrer",className:"hover:underline "+e.className,children:e.children})}function LinkToAuthor(e){let t="https://news.ycombinator.com/user?id=".concat(e.author);return(0,n.jsx)(ExternalLink,{href:t,className:e.className,children:e.author})}function LinkToDiscussion(e){return(0,n.jsx)(LinkToDiscussionWrapper,{discussionId:e.discussionId,className:e.className,children:(0,a._m)(e.createdAt)})}function LinkToDiscussionWrapper(e){let t="https://news.ycombinator.com/item?id=".concat(e.discussionId);return(0,n.jsx)(ExternalLink,{href:t,className:e.className,children:e.children})}r(2265)},6750:function(e,t,r){"use strict";r.d(t,{C2:function(){return ILinkToDiscussion},h$:function(){return InternalLink},oo:function(){return ILinkToDiscussionWrapper}});var n=r(7437),a=r(7766),o=r(1396),s=r.n(o);function InternalLink(e){return(0,n.jsx)(s(),{href:e.href,className:"hover:underline "+e.className,children:e.children})}function ILinkToDiscussion(e){return(0,n.jsx)(ILinkToDiscussionWrapper,{discussionId:e.discussionId,className:e.className,children:(0,a._m)(e.createdAt)})}function ILinkToDiscussionWrapper(e){let t="/item?id=".concat(e.discussionId);return(0,n.jsx)(InternalLink,{href:t,className:e.className,children:e.children})}r(2265)},3107:function(e,t,r){"use strict";r.d(t,{E:function(){return RadioButton}});var n=r(7437);function RadioButton(e){let{label:t,value:r,checked:a,onChange:o}=e;return(0,n.jsxs)("label",{className:"text-xs flex items-center gap-1",children:[(0,n.jsx)("input",{type:"radio",value:r,checked:a,onChange:o}),t]})}},4466:function(e,t,r){"use strict";r.d(t,{j:function(){return FrontPageViewerWrapper}});var n=r(7437),a=r(9077),o=r(7862);function useHnPage(e){let t=getQueryKey(e),r=(0,a.useQuery)(t,()=>fetchHackerNewsFrontPage(e));return r}function getQueryKey(e){return"front_page"===e.tag?"front_page_".concat(e.pageSize,"_").concat(e.page):"".concat(e.tag,"_").concat(e.createdAfterI,"_").concat(e.createdBeforeI,"_").concat(e.pageSize,"_").concat(e.page)}async function fetchHackerNewsFrontPage(e){let t=getQueryUrl(e);return fetch(t).then(e=>e.json())}function getQueryUrl(e){let t=new QueryBuilder;return t.addTag(e.tag),t.addPageSize(e.pageSize),t.addPage(e.page-1),"front_page"!==e.tag&&(t.setPath("search_by_date"),t.addCreatedBeforeAfter({before:e.createdBeforeI,after:e.createdAfterI})),t.build()}let QueryBuilder=class QueryBuilder{setPath(e){return this.path=e,this}addTag(e){return this.queryString+="tags=".concat(e,"&"),this}addCreatedBeforeAfter(e){return this.queryString+="numericFilters=created_at_i>".concat(e.after,",created_at_i<").concat(e.before,"&"),this}addPage(e){return this.queryString+="page=".concat(e,"&"),this}addPageSize(e){return this.queryString+="hitsPerPage=".concat(e,"&"),this}build(){let e="".concat(this.baseUrl).concat(this.path,"?").concat(this.queryString);return e}constructor(){this.queryString="",this.baseUrl="https://hn.algolia.com/api/v1/",this.path="search"}};var s=r(1170),i=r(6750);function FrontPageViewer(e){let t=e.data,r=e.data.page,a=e.data.hitsPerPage;return(0,n.jsx)("div",{className:"flex flex-col gap-1 font-sans",children:t.hits.map((e,t)=>(0,n.jsx)(FrontPageItem,{index:t+1+a*r,item:e},e.objectID))})}function FrontPageItem(e){let{item:t,index:r}=e;return(0,n.jsxs)("div",{className:"flex flex-row items-start gap-1",children:[(0,n.jsxs)("span",{children:[r,"."]}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)(s.dL,{href:t.url,children:t.title}),(0,n.jsxs)("div",{className:"flex items-center flex-wrap gap-1 text-gray-500 text-xxs sm:text-xs",children:[(0,n.jsxs)("p",{className:"flex-shrink-0",children:[t.points," points by"]}),(0,n.jsx)(s.Av,{author:t.author}),(0,n.jsx)(i.C2,{discussionId:Number(t.objectID),createdAt:t.created_at}),(0,n.jsx)("span",{children:"|"}),(0,n.jsxs)(i.oo,{discussionId:Number(t.objectID),children:[t.num_comments," comments"]})]})]})]})}var u=r(2265),c=r(2154);function FrontPageFooter(e){let t=Array(e.pageCount).fill(0).map((e,t)=>t+1),{patchQueryParams:r}=(0,c.Fs)();return(0,n.jsx)("div",{className:"flex gap-2 pt-4 justify-center w-full flex-wrap",children:t.map(e=>(0,n.jsx)("span",{className:"cursor-pointer hover:underline",onClick:()=>r({page:e}),children:e},e))})}var l=r(1983),d=r(3107),f=r(7766);function FrontPageViewerWrapper(e){return(0,n.jsx)(a.QueryClientProvider,{client:o.E,children:(0,n.jsx)(PageViewer,{...e})})}function PageViewer(e){let t=useHnPage(e),[r,a]=(0,u.useState)("Sort by points"),o=useFrontPageSort(t.data,r),{patchQueryParams:s}=(0,c.Fs)();if(t.isLoading)return(0,n.jsx)(l.a,{});if("error"===t.status)return(0,n.jsxs)("div",{children:["Problem loading data, err: ",t.error+""]});if(!t.data||!o)return(0,n.jsx)("div",{children:"No data?..."});let i="front_page"!==e.tag,d=i&&(0,n.jsx)(DateButtons,{createdBeforeI:e.createdBeforeI,onClickYesterday:()=>{let t=(0,f.kl)(e.createdBeforeI);s({createdAfterI:(0,f.kl)(t),createdBeforeI:t,page:1})},onClickTomorrow:()=>{s({createdAfterI:e.createdBeforeI,createdBeforeI:(0,f.VJ)(e.createdBeforeI),page:1})}});return(0,n.jsxs)("div",{className:"flex flex-col w-full",children:[(0,n.jsx)("div",{className:"pb-3",children:d}),(0,n.jsx)(SortOptions,{value:r,onChange:a}),(0,n.jsx)(FrontPageViewer,{data:o}),(0,n.jsx)(FrontPageFooter,{pageCount:t.data.nbPages}),(0,n.jsx)("table",{children:(0,n.jsxs)("tbody",{children:[(0,n.jsx)(OptionRow,{label:"Per page",option:(0,n.jsx)(PerPageOptions,{value:e.pageSize,onChange:e=>s({perPage:e})})}),i&&(0,n.jsx)(OptionRow,{label:"Date",option:(0,n.jsx)(DateSelect,{valueDateString:(0,f.nz)(e.createdBeforeI),onChange:e=>s({createdAfterI:(0,f.kl)(e),createdBeforeI:e,page:1})})}),i&&(0,n.jsx)(OptionRow,{label:"",option:d})]})})]})}function OptionRow(e){return(0,n.jsxs)("tr",{className:"py-1",children:[(0,n.jsx)("td",{className:"pr-2 w-24",children:e.label}),(0,n.jsx)("td",{className:"",children:e.option})]})}function PerPageOptions(e){return(0,n.jsxs)("select",{value:e.value,className:"border border-gray-300 p-1",onChange:t=>e.onChange(parseInt(t.target.value)),children:[(0,n.jsx)("option",{children:"50"}),(0,n.jsx)("option",{children:"100"})]})}let h=(0,f.tt)();function DateSelect(e){let onInput=t=>{e.onChange((0,f.mb)(new Date(t)))};return(0,n.jsx)("input",{type:"date",value:e.valueDateString||h,onChange:e=>onInput(e.target.value)})}function DateButtons(e){let t=u.useMemo(()=>{let t=(0,f.OP)(1,"day"),r=e.createdBeforeI<t;return r},[e.createdBeforeI]);return(0,n.jsxs)("div",{className:"flex justify-between underline",children:[(0,n.jsx)("button",{onClick:e.onClickYesterday,children:"Previous Day"}),t?(0,n.jsx)("button",{onClick:e.onClickTomorrow,children:"Next Day"}):(0,n.jsx)("div",{})]})}function useFrontPageSort(e,t){if(!e)return;let r=[...e.hits].sort("Sort by points"===t?sortByPoints:sortByComments);return{...e,hits:r}}function sortByPoints(e,t){return t.points-e.points}function sortByComments(e,t){return t.num_comments-e.num_comments}function SortOptions(e){return(0,n.jsx)("div",{className:"flex items-center gap-2 border border-gray-300 p-2 rounded mb-2",children:["Sort by points","Sort by comments"].map(t=>(0,n.jsx)(d.E,{value:t,label:t,checked:t===e.value,onChange:r=>e.onChange(t)},t))})}},1983:function(e,t,r){"use strict";r.d(t,{a:function(){return LoadingScreen}});var n=r(7437),a=r(2265);let o=["⊖_⊖","⊜_⊜","⊙_⊙"];function LoadingScreen(){let[e,t]=a.useState(0);return useTimeout(()=>{let r=(e+1)%o.length;t(r)},2e3*Math.random()),(0,n.jsxs)("div",{className:"flex flex-col items-center py-40 w-full",children:[(0,n.jsx)("p",{className:"text-3xl font-mono text-gray-600 pb-10",children:"Loading..."}),(0,n.jsx)("p",{className:"text-4xl font-mono whitespace-pre text-gray-400",children:o[e]})]})}function useTimeout(e,t){a.useEffect(()=>{let r=setTimeout(()=>{e()},t);return()=>{clearTimeout(r)}},[e,t])}},7766:function(e,t,r){"use strict";r.d(t,{Iz:function(){return getNow},OP:function(){return getNowMinus},VJ:function(){return add24Hours},_m:function(){return getFromNowStr},kl:function(){return minus24Hours},mb:function(){return dateToHnSeconds},mu:function(){return getDateStr},nz:function(){return secondsToDateString},tt:function(){return todayDateString}});var n=r(4548),a=r.n(n),o=r(6537),s=r.n(o);function getFromNowStr(e){return a()(e).fromNow()}function getDateStr(e){return a()(e).format("YYYY-MM-DD")}function getNow(){return toSeconds(roundHour(a()()))}function getNowMinus(e,t){return toSeconds(roundHour(a()().subtract(e,t)))}function minus24Hours(e){return toSeconds(roundHour(a()(1e3*e).subtract(24,"hours")))}function add24Hours(e){return toSeconds(roundHour(a()(1e3*e).add(24,"hours")))}function roundHour(e){return e.minute(0).second(0).millisecond(0)}function toSeconds(e){return Math.round(Number(e.toDate())/1e3)}function dateToHnSeconds(e){return toSeconds(roundHour(a()(e)))}function secondsToDateString(e){return formatForDateInput(a()(new Date(1e3*e)))}function todayDateString(){return formatForDateInput(a()())}function formatForDateInput(e){return e.format("YYYY-MM-DD")}a().extend(s())},5232:function(e,t,r){"use strict";r.d(t,{t:function(){return useIsMounted}});var n=r(2265);function useIsMounted(){let[e,t]=n.useState(!1);return n.useEffect(()=>{t(!0)},[]),e}},2154:function(e,t,r){"use strict";r.d(t,{Fs:function(){return useSetUrlQueryParams},OZ:function(){return useHnQueryUrlParams},kI:function(){return usePageFromParams}});var n=r(4033),a=r(7766);function usePageFromParams(){let e=(0,n.useSearchParams)();return Number((null==e?void 0:e.get("page"))||1)}function useHnQueryUrlParams(){let e=(0,n.useSearchParams)();function getParam(t){return null==e?void 0:e.get(t)}let t={page:1,perPage:50,createdBeforeI:(0,a.Iz)(),createdAfterI:(0,a.OP)(24,"hours")},r=Number(getParam("page")||t.page),o=Number(getParam("perPage")||t.perPage),s=Number(getParam("createdAfterI")||t.createdAfterI),i=Number(getParam("createdBeforeI")||t.createdBeforeI);return{page:r,perPage:o,createdAfterI:s,createdBeforeI:i}}function useSetUrlQueryParams(){let e=(0,n.useRouter)(),t=(0,n.usePathname)();return{patchQueryParams:function(r){let n=new URLSearchParams(window.location.search),a=Array.from(n.entries()).reduce((e,t)=>{let[r,n]=t;return e[r]=n,e},{}),o={...a,...r},s=Object.entries(o).map(e=>{let[t,r]=e;return"".concat(t,"=").concat(r)}).join("&");e.push(t+"?".concat(s))}}}},1396:function(e,t,r){e.exports=r(8326)}}]);