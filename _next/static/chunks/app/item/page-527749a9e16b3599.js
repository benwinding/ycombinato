(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[269],{3510:function(e,t,n){Promise.resolve().then(n.bind(n,9370))},9370:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var l,s,r=n(9268),a=n(6006);let c=async e=>fetch("https://hn.algolia.com/api/v1/items/".concat(e)).then(e=>e.json()),i=()=>{let[e,t]=a.useState();return a.useEffect(()=>{let e=window.location.search,n=new URLSearchParams(e);t(n)},[]),e};var o=n(4824),d=n(9829),h=n(8550);let u=new o.QueryClient({defaultOptions:{queries:{cacheTime:36e5}}}),x=(0,d.O)({storage:(()=>{try{return window.localStorage}catch(e){return null}})()});(0,h.w)({queryClient:u,persistor:x,maxAge:36e5,hydrateOptions:{},dehydrateOptions:{}});let m=()=>(0,r.jsx)(o.QueryClientProvider,{client:u,children:(0,r.jsx)(p,{})}),p=()=>{let[e,t]=a.useState("Sort by response count"),n=i(),l=null==n?void 0:n.get("id"),s=(0,o.useQuery)("post",()=>c(l+""),{enabled:null!=l}),d=s.data,h=(0,a.useMemo)(()=>d?function(e,t){if(!e)return e;let n={...e};if(t.byThreadLength){let e=(t,n)=>{let l=n.children||[];if(!l.length)return t;let s=l.reduce((n,l)=>{let s=e(t+1,l);return s>n?s:n},0);return s},t=(t,n)=>e(0,n)-e(0,t);n.children=n.children.sort(t)}return t.byResponseCount&&(n.children=n.children.sort((e,t)=>t.children.length-e.children.length)),n}(d,{byResponseCount:"Sort by response count"===e,byThreadLength:"Sort by thread length"===e}):void 0,[d,e]);return(0,r.jsxs)("div",{className:"flex flex-col py-1 px-2",children:[(0,r.jsx)(f,{onChange:t,value:e}),s.isLoading&&s.isFetching&&(0,r.jsx)("div",{children:"Loading..."}),h&&(0,r.jsx)(y,{title:h.title,comments:h.children})]})};function f(e){return(0,r.jsx)("div",{className:"flex items-center gap-2",children:["Sort by response count","Sort by thread length"].map(t=>(0,r.jsx)(g,{value:t,label:t,checked:t===e.value,onChange:n=>e.onChange(t)},t))})}function g(e){let{label:t,value:n,checked:l,onChange:s}=e;return(0,r.jsxs)("label",{className:"text-xs flex items-center gap-1",children:[(0,r.jsx)("input",{type:"radio",value:n,checked:l,onChange:s}),t]})}(l=s||(s={})).byResponseCount="Sort by response count",l.byThreadLength="Sort by thread length";let y=e=>(0,r.jsx)("div",{className:"font-sans",children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("h1",{className:"text-xl font-bold",children:e.title}),e.comments.map(e=>(0,r.jsx)(b,{comment:e},e.id))]})}),b=e=>(0,r.jsxs)("ul",{className:"list-decimal bg-black bg-opacity-5 rounded pl-2",children:[(0,r.jsx)("div",{className:"",children:(0,r.jsx)("div",{className:"text-xs py-1 pr-2",dangerouslySetInnerHTML:{__html:e.comment.text}})}),(0,r.jsx)("div",{className:"flex flex-col gap-2",children:e.comment.children.map(e=>(0,r.jsx)(b,{comment:e},e.id))})]}),j=()=>{let[e,t]=a.useState(!1);return a.useEffect(()=>{t(!0)},[]),e&&(0,r.jsx)(m,{})};var v=j}},function(e){e.O(0,[303,667,139,744],function(){return e(e.s=3510)}),_N_E=e.O()}]);